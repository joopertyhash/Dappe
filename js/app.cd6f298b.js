(function(e){function t(t){for(var a,n,i=t[0],c=t[1],u=t[2],l=0,p=[];l<i.length;l++)n=i[l],Object.prototype.hasOwnProperty.call(r,n)&&r[n]&&p.push(r[n][0]),r[n]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);d&&d(t);while(p.length)p.shift()();return o.push.apply(o,u||[]),s()}function s(){for(var e,t=0;t<o.length;t++){for(var s=o[t],a=!0,n=1;n<s.length;n++){var i=s[n];0!==r[i]&&(a=!1)}a&&(o.splice(t--,1),e=c(c.s=s[0]))}return e}var a={},n={app:0},r={app:0},o=[];function i(e){return c.p+"js/"+({"about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text":"about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text","about~receive~send~settings~sweep~text":"about~receive~send~settings~sweep~text",about:"about","receive~send~sweep":"receive~send~sweep",receive:"receive","send~settings~sweep":"send~settings~sweep",send:"send",sweep:"sweep",settings:"settings",text:"text",asset:"asset",assets:"assets",login:"login",payments:"payments",home:"home",register:"register"}[e]||e)+"."+{"about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text":"25eac064","about~receive~send~settings~sweep~text":"3815fc63",about:"f4c05bd5","receive~send~sweep":"5137a25a",receive:"8e0c36fc","send~settings~sweep":"5a4c8573",send:"14d4b95e",sweep:"b8dad1e2",settings:"3bccd656",text:"8216f9ae",asset:"76d47735",assets:"48603f59",login:"0c92d94c",payments:"0cfac29e",home:"3c109527",register:"03f0effb"}[e]+".js"}function c(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,c),s.l=!0,s.exports}c.e=function(e){var t=[],s={"about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text":1,about:1,"receive~send~sweep":1,receive:1,"send~settings~sweep":1,send:1,sweep:1,settings:1,text:1,assets:1,login:1,payments:1,home:1};n[e]?t.push(n[e]):0!==n[e]&&s[e]&&t.push(n[e]=new Promise((function(t,s){for(var a="css/"+({"about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text":"about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text","about~receive~send~settings~sweep~text":"about~receive~send~settings~sweep~text",about:"about","receive~send~sweep":"receive~send~sweep",receive:"receive","send~settings~sweep":"send~settings~sweep",send:"send",sweep:"sweep",settings:"settings",text:"text",asset:"asset",assets:"assets",login:"login",payments:"payments",home:"home",register:"register"}[e]||e)+"."+{"about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text":"976b6bb8","about~receive~send~settings~sweep~text":"31d6cfe0",about:"2f1a3a9b","receive~send~sweep":"4b5691eb",receive:"7b2afcdb","send~settings~sweep":"f0723578",send:"b9b6bb54",sweep:"acecb03d",settings:"63a2c326",text:"ca6df252",asset:"31d6cfe0",assets:"24c1e446",login:"9753a97f",payments:"955e884e",home:"744fdf57",register:"31d6cfe0"}[e]+".css",r=c.p+a,o=document.getElementsByTagName("link"),i=0;i<o.length;i++){var u=o[i],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===a||l===r))return t()}var p=document.getElementsByTagName("style");for(i=0;i<p.length;i++){u=p[i],l=u.getAttribute("data-href");if(l===a||l===r)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var a=t&&t.target&&t.target.src||r,o=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=a,delete n[e],d.parentNode.removeChild(d),s(o)},d.href=r;var m=document.getElementsByTagName("head")[0];m.appendChild(d)})).then((function(){n[e]=0})));var a=r[e];if(0!==a)if(a)t.push(a[2]);else{var o=new Promise((function(t,s){a=r[e]=[t,s]}));t.push(a[2]=o);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=i(e);var p=new Error;u=function(t){l.onerror=l.onload=null,clearTimeout(d);var s=r[e];if(0!==s){if(s){var a=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;p.message="Loading chunk "+e+" failed.\n("+a+": "+n+")",p.name="ChunkLoadError",p.type=a,p.request=n,s[1](p)}r[e]=void 0}};var d=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(t)},c.m=e,c.c=a,c.d=function(e,t,s){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(c.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(s,a,function(t){return e[t]}.bind(null,a));return s},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=t,u=u.slice();for(var p=0;p<u.length;p++)t(u[p]);var d=l;o.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},1:function(e,t){},"111d":function(e,t,s){},2:function(e,t){},"2f4c":function(e,t,s){"use strict";var a=s("c2d7"),n=s.n(a);n.a},3:function(e,t){},4:function(e,t){},"4a08":function(e,t,s){"use strict";var a=s("626b"),n=s.n(a);n.a},5:function(e,t){},"56d7":function(e,t,s){"use strict";s.r(t);var a=s("2b0e"),n=s("a7fe"),r=s.n(n),o=s("bc3a"),i=s.n(o),c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",{attrs:{id:"app"}},[s("top-bar"),s("snack-bar"),s("v-content",{staticStyle:{background:"#333"}},[s("v-container",{staticClass:"mr-3",staticStyle:{"margin-bottom":"50px !important"}},[e.versionMismatch?s("v-alert",{staticClass:"mb-2",attrs:{color:"error",dismissible:"",transition:"scale-transition"}},[e._v("Version mismatch: "+e._s(e.versionMismatch)+" "),s("v-btn",{on:{click:e.refresh}},[s("v-icon",{attrs:{left:""}},[e._v("refresh")]),e._v(" Refresh")],1)],1):e._e(),e.error?s("v-alert",{staticClass:"mb-2",attrs:{color:"error",dismissible:"",transition:"scale-transition"}},[e._v(e._s(e.error))]):e._e(),s("two-fa"),e.initializing?s("v-progress-linear",{attrs:{indeterminate:""}}):s("router-view",{key:e.$route.path})],1)],1),e.user&&e.user.address?s("bottom-nav"):e._e()],1)},u=[],l=s("7ffd"),p=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"footer"}},[s("v-bottom-navigation",{staticClass:"d-flex justify-space-around text-center",attrs:{height:"60","background-color":"#212121",dark:""}},[s("v-btn",{staticClass:"flex-grow-1",attrs:{text:""},on:{click:e.home}},[s("span",[e._v("Payments")]),s("v-icon",[e._v("line_weight")])],1),s("v-btn",{staticClass:"flex-grow-1",attrs:{text:""},on:{click:function(t){return e.$go("/receive?refresh")}}},[s("span",[e._v("Receive")]),s("v-icon",{staticClass:"mr-1"},[e._v("get_app")])],1),s("v-btn",{staticClass:"flex-grow-1",attrs:{text:""},on:{click:function(t){return e.$go("/scan")}}},[s("span",[e._v("Scan")]),s("v-icon",[e._v("camera_alt")])],1),e.user?s("v-btn",{staticClass:"flex-grow-1",attrs:{text:""},on:{click:function(t){return e.$go("/send?refresh")}}},[s("span",[e._v("Send")]),s("send")],1):e._e(),s("v-btn",{staticClass:"flex-grow-1",attrs:{text:""},on:{click:function(t){return e.$go("/settings")}}},[s("span",[e._v("Settings")]),s("v-icon",[e._v("settings")])],1)],1)],1)},d=[],m=s("c2d8"),g=s("2f62"),h={components:{Send:m["a"]},computed:Object(g["c"])(["user"]),methods:{home(){this.$go("/home"),window.scrollTo(0,0)},...Object(g["b"])(["scan"])}},f=h,b=(s("4a08"),s("2877")),v=s("6544"),y=s.n(v),w=s("b81c"),x=s("8336"),k=s("132d"),S=Object(b["a"])(f,p,d,!1,null,null,null),_=S.exports;y()(S,{VBottomNavigation:w["a"],VBtn:x["a"],VIcon:k["a"]});var C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-snackbar",{staticClass:"snack yellow--text",attrs:{timeout:5e3,top:""},model:{value:e.snack,callback:function(t){e.snack=t},expression:"snack"}},[s("info-icon",{staticClass:"mr-1"}),s("b",[e._v(e._s(e.message))])],1)},O=[],A=s("4611"),P={components:{InfoIcon:A["a"]},computed:{message:{get(){return this.$store.getters.snack},set(e){this.$store.commit("snack",e)}},snack:{get(){return this.message},set(e){e||(this.message=e)}}}},T=P,j=s("2db4"),N=Object(b["a"])(T,C,O,!1,null,null,null),$=N.exports;y()(N,{VSnackbar:j["a"]});var V=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app-bar",{attrs:{absolute:"",app:"",dark:"",color:"black",fixed:""}},[s("v-toolbar-title",{staticClass:"display-2 unselectable",staticStyle:{cursor:"pointer"},attrs:{dark:""},on:{click:e.goHome}},[s("span",{staticClass:"headline font-weight-black"},[e._v("C-")]),s("span",{staticClass:"yellow--text headline font-weight-black"},[e._v("Pago")]),s("span",{staticClass:"subtitle-1 font-weight-black"},[e._v(".")])]),s("v-spacer"),e.user&&e.user.address&&e.user.username?s("v-menu",{staticClass:"ml-2",attrs:{"offset-y":"","nudge-bottom":"1"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[s("v-btn",e._g({},a),[e.user.pic?s("v-avatar",{staticClass:"mr-2",attrs:{size:"30"}},[s("img",{attrs:{src:e.user.pic}})]):s("v-icon",[e._v("person")]),s("span",{staticClass:"truncate"},[e._v(e._s(e.user.username))])],1)]}}],null,!1,2444660962)},[s("v-card",{staticClass:"mx-auto menu",attrs:{tile:"","max-width":"400"}},[s("v-list-item",{on:{click:function(t){return e.$go("/about")}}},[s("v-list-item-action",[s("v-icon",[e._v("help")])],1),s("v-list-item-content",[e._v("About")])],1),e.user&&e.user.accounts?s("v-list-item",{on:{click:function(t){return e.$go("/assets")}}},[s("v-list-item-action",[s("v-icon",[e._v("account_balance_wallet")])],1),s("v-list-item-content",[e._v("Assets")])],1):e._e(),s("v-list-item",{on:{click:function(t){return e.$go("/settings")}}},[s("v-list-item-action",[s("v-icon",[e._v("settings")])],1),s("v-list-item-content",[e._v("Settings")])],1),s("v-list-item",{on:{click:function(t){return e.$go("/logout")}}},[s("v-list-item-action",[s("power-settings-icon",{attrs:{title:"Logout"}})],1),s("v-list-item-content",[e._v("Logout")])],1)],1)],1):s("v-btn",{attrs:{icon:""},on:{click:function(t){return e.$go("/about")}}},[s("v-icon",[e._v("help")])],1)],1)},I=[],B=s("0ce9"),q={components:{PowerSettingsIcon:B["a"]},computed:{accounts(){return["BTC",...this.user.accounts.map(e=>e.asset)]},asset:Object(l["e"])("asset"),user:Object(l["c"])("user")},methods:{goHome(){this.user&&this.user.address?this.$go("/home"):this.$go("/")}}},L=q,F=(s("2f4c"),s("40dc")),J=s("8212"),M=s("b0af"),R=s("da13"),E=s("1800"),W=s("5d23"),z=s("e449"),U=s("2fa4"),H=s("2a7f"),G=Object(b["a"])(L,V,I,!1,null,"3aab3580",null),D=G.exports;y()(G,{VAppBar:F["a"],VAvatar:J["a"],VBtn:x["a"],VCard:M["a"],VIcon:k["a"],VListItem:R["a"],VListItemAction:E["a"],VListItemContent:W["a"],VMenu:z["a"],VSpacer:U["a"],VToolbarTitle:H["a"]});const K=new a["a"]({data(){return{prompt:null}},created(){window.addEventListener("beforeinstallprompt",e=>{window.matchMedia("(display-mode: standalone)").matches||(this.prompt=e)})}});var Z=K,Q=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-dialog",{attrs:{"max-width":"350"},model:{value:e.prompt2fa,callback:function(t){e.prompt2fa=t},expression:"prompt2fa"}},[s("v-card",[s("v-card-title",{staticClass:"subheading"},[e._v("2FA Code Required")]),s("v-card-text",[s("pincode-input",{key:e.key,ref:"twofa",staticClass:"mx-auto yellow--text",attrs:{placeholder:"0",length:6},model:{value:e.twofa,callback:function(t){e.twofa=t},expression:"twofa"}})],1)],1)],1)},X=[],Y=s("a7d0"),ee={components:{PincodeInput:Y["a"]},data(){return{key:"a"}},computed:{user:Object(l["c"])("user"),prompt2fa:Object(l["e"])("prompt2fa"),twofa:Object(l["e"])("twofa")},methods:{login:Object(l["a"])("login")},watch:{prompt2fa(e){this.twofa="",this.key+="a"},twofa(e){6===e.length&&(this.prompt2fa=!1,this.login(this.user))}}},te=ee,se=s("99d9"),ae=s("169a"),ne=Object(b["a"])(te,Q,X,!1,null,null,null),re=ne.exports;y()(ne,{VCard:M["a"],VCardText:se["b"],VCardTitle:se["c"],VDialog:ae["a"]});var oe=["/login","/about","/register","/forgot"],ie={components:{BottomNav:_,SnackBar:$,TopBar:D,TwoFa:re},data(){return{installed:!1}},computed:{initializing:Object(l["c"])("initializing"),loading:Object(l["c"])("loading"),socket:Object(l["c"])("socket"),user:Object(l["e"])("user"),versionMismatch:Object(l["c"])("versionMismatch"),publicPath(){return oe.includes(this.$route.path)},prompt(){return Z.prompt},promptInstall(){return this.prompt&&!this.installed},webscanning(){return this.scanning&&!window.QRScanner},error:Object(l["e"])("error")},watch:{$route(){this.socket&&this.user||this.init()}},methods:{refresh(){window.location.reload(!0)},updateUser:Object(l["a"])("updateUser"),init:Object(l["a"])("init"),handleScan:Object(l["a"])("handleScan"),showText:Object(l["a"])("showText"),async install(){const{outcome:e}=await this.prompt.prompt();"accepted"===e&&(this.installed=!0)}}},ce=ie,ue=(s("7faf"),s("0798")),le=s("7496"),pe=s("a523"),de=s("a75b"),me=s("8e36"),ge=Object(b["a"])(ce,c,u,!1,null,null,null),he=ge.exports;y()(ge,{VAlert:ue["a"],VApp:le["a"],VBtn:x["a"],VContainer:pe["a"],VContent:de["a"],VIcon:k["a"],VProgressLinear:me["a"]});var fe=s("8c4f");const be=()=>Promise.all([s.e("about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text"),s.e("about~receive~send~settings~sweep~text"),s.e("about")]).then(s.bind(null,"84ba")),ve=()=>Promise.all([s.e("about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text"),s.e("asset")]).then(s.bind(null,"80e4")),ye=()=>Promise.all([s.e("about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text"),s.e("assets")]).then(s.bind(null,"4d1d")),we=()=>Promise.all([s.e("about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text"),s.e("payments"),s.e("home")]).then(s.bind(null,"cbcc")),xe=()=>Promise.all([s.e("about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text"),s.e("payments"),s.e("home")]).then(s.bind(null,"57da")),ke=()=>Promise.all([s.e("about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text"),s.e("login")]).then(s.bind(null,"578a")),Se=()=>Promise.all([s.e("about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text"),s.e("payments")]).then(s.bind(null,"ae1d")),_e=()=>Promise.all([s.e("about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text"),s.e("about~receive~send~settings~sweep~text"),s.e("receive~send~sweep"),s.e("receive")]).then(s.bind(null,"728c")),Ce=()=>Promise.all([s.e("about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text"),s.e("register")]).then(s.bind(null,"1feb")),Oe=()=>Promise.all([s.e("about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text"),s.e("about~receive~send~settings~sweep~text"),s.e("receive~send~sweep"),s.e("send~settings~sweep"),s.e("send")]).then(s.bind(null,"4d17")),Ae=()=>Promise.all([s.e("about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text"),s.e("about~receive~send~settings~sweep~text"),s.e("receive~send~sweep"),s.e("send~settings~sweep"),s.e("send")]).then(s.bind(null,"42ba")),Pe=()=>Promise.all([s.e("about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text"),s.e("about~receive~send~settings~sweep~text"),s.e("send~settings~sweep"),s.e("settings")]).then(s.bind(null,"f9ea")),Te=()=>Promise.all([s.e("about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text"),s.e("about~receive~send~settings~sweep~text"),s.e("receive~send~sweep"),s.e("send~settings~sweep"),s.e("sweep")]).then(s.bind(null,"235b")),je=()=>Promise.all([s.e("about~asset~assets~home~login~payments~receive~register~send~settings~sweep~text"),s.e("about~receive~send~settings~sweep~text"),s.e("text")]).then(s.bind(null,"e25f")),Ne=[{path:"/",component:xe,props:{logout:!1}},{path:"/about",component:be},{path:"/asset",component:ve},{path:"/assets",component:ye},{path:"/decrypt",component:we},{path:"/home",component:xe},{path:"/login",component:ke,props:{logout:!1}},{path:"/logout",component:ke,props:{logout:!0}},{path:"/payments",component:Se},{path:"/receive",component:_e},{path:"/register",component:Ce},{path:"/scan",component:Oe},{name:"send",path:"/send",component:Ae,props:!0},{path:"/settings",component:Pe},{path:"/sweep",component:Te},{path:"/text",component:je}];a["a"].use(fe["a"]);var $e=new fe["a"]({mode:"history",routes:Ne,scrollBehavior:function(e,t,s){return s||{x:0,y:0}}}),Ve=(s("bf2b"),s("7279")),Ie=s.n(Ve),Be=s("53b8"),qe=s.n(Be),Le=s("3746"),Fe=s("59da"),Je=function(e,t){if(parseInt(t)){let a=e/10**t;if(Math.abs(a)<1){var s=parseInt(a.toString().split("e-")[1]);s&&(a*=Math.pow(10,s-1),a=a.toFixed(9-s),a="0."+new Array(s).join("0")+a.toString().substring(2))}else{s=parseInt(a.toString().split("+")[1]);s>20&&(s-=20,a/=Math.pow(10,s),a+=new Array(s+1).join("0"))}return a}return parseInt(e).toFixed(0)};a["a"].use(g["a"]);const Me=1e8,Re={bitcoin:"BTC",liquid:"LBTC",lightning:"LNBTC"},Ee=["p2sh-segwit","legacy","bech32"];l["b"].options.mapping="simple";const We=e=>e.startsWith("Az")||e.startsWith("lq1")||e.startsWith("VJL")||e.startsWith("VT")||e.startsWith("XR")||(e.startsWith("H")||e.startsWith("G"))&&34===e.length||e.startsWith("ert1q")&&43===e.length||e.startsWith("ex1q")&&42===e.length,ze=console.log,Ue=e=>{e===$e.currentRoute.path||e.name===$e.currentRoute.path.substr(1)||$e.push(e)},He="6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d",Ge=JSON.stringify({amount:null,currency:"",fiatAmount:null,fiatTip:null,method:"",rate:0,received:0,text:"",tip:0}),De=JSON.stringify({account:null,address:"",amount:null,asset:He,feeRate:null,fiatAmount:null,method:null,network:null,payment:null,payobj:null,payreq:"",recipient:null,route:null,sent:!1,tip:null,tx:null}),Ke={addressTypes:Ee,asset:He,assets:[],challenge:"",channels:[],ecpair:null,error:"",fiat:!0,friends:[],info:null,invoice:JSON.parse(Ge),invoices:[],initializing:!0,loading:!1,loadingFee:!1,nodes:[],orders:[],payment:JSON.parse(De),payments:[],psbt:null,pin:"",prompt2fa:!1,rate:0,rates:null,received:JSON.parse(De),snack:"",socket:null,subscription:null,text:"",token:null,twofa:"",user:{address:null,balance:null},versionMismatch:null,version:null};var Ze=new g["a"].Store({plugins:[l["b"].plugin],state:Ke,actions:{async init({commit:e,getters:t,dispatch:s,state:n}){const{path:r}=$e.currentRoute;if(e("error",""),"/login"===r||"/register"===r)return e("initializing",!1),void e("loading",!1);let o=t.token||window.sessionStorage.getItem("token");if(!o){let e=("; "+document.cookie).match(";\\s*token=([^;]+)");e&&e[1]&&(o=e[1])}try{let t=(await a["a"].axios.get("/info")).data;e("assets",(await a["a"].axios.get("/assets")).data),e("info",t),e("nodes",t.nodes),e("rates",t.rates),e("version",t.clientVersion.trim())}catch(i){ze(i),e("error","Problem connecting to server")}if(o&&"null"!==o){e("token",o);let a=0;try{await s("setupSocket");const n=async()=>{try{await s("setupSocket"),a=0}catch(i){a>5?e("error","Problem connecting to server"):a++}t.user&&t.token&&setTimeout(n,5e3)};n(),e("initializing",!1),e("loading",!1),"/"!==r&&"/register"!==r||Ue("/home")}catch(i){ze("failed to setup sockets",i),Ue("/login")}}else oe.includes(r)?e("initializing",!1):Ue("/login")},async getAddress({commit:e,getters:t,dispatch:s}){},async getChallenge({commit:e,getters:t,dispatch:s}){try{let t=await a["a"].axios.get("/challenge");e("challenge",t.data)}catch(n){e("error",n.response?n.response.data:n.message)}},async login({commit:e,dispatch:t,state:s},n){e("user",n),n.token=s.twofa;try{let t=await a["a"].axios.post("/login",n);e("user",t.data.user),e("token",t.data.token)}catch(r){return void(r.response&&r.response.data.startsWith("2fa")?e("prompt2fa",!0):e("error","Login failed"))}await t("init"),"/home"!==$e.currentRoute.path&&Ue("/home")},async getNewAddress({commit:e,dispatch:t,state:s}){let n=s.addressTypes.shift();s.addressTypes.push(n),s.invoice.address=(await a["a"].axios.post("/address",{type:n})).data,t("addInvoice")},async enable2fa(e,t){await a["a"].axios.post("/2fa",{token:t})},async disable2fa(e,t){await a["a"].axios.post("/disable2fa",{token:t})},async toggleUnit({commit:e,dispatch:t,state:s}){"BTC"===s.user.account.ticker&&(s.user.unit="SAT"===s.user.unit?"BTC":"SAT",t("updateUser",s.user))},async shiftCurrency({commit:e,dispatch:t,state:s}){const{invoice:a,user:n}=s;let{currencies:r}=n;Array.isArray(r)||(r=JSON.parse(n.currencies));let o=r.findIndex(e=>e===n.currency)+1;o===r.length&&(o=0);let i=r[o];t("setCurrency",i)},async setCurrency({commit:e,dispatch:t,getters:s,state:a},n){const{invoice:r,rates:o,user:i}=a;if(!i.currencies.includes(n)||!o[n])return;const c=o[n];i.currency=n,r.currency=n,r.rate=c,r.fiatAmount=(r.amount*c/Me).toFixed(2),r.fiatTip=(r.tip*c/Me).toFixed(2),a.fiatAmount=(a.amount*c/Me).toFixed(2),e("rate",c),t("updateUser",i)},async logout({commit:e,state:t}){let{subscription:s}=t;a["a"].axios.post("/logout",{subscription:s}),document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:01 GMT;",window.sessionStorage.removeItem("token"),e("token",null),e("pin",null),e("user",null),t.socket&&t.socket.close(),e("socket",null),e("subscription",null),Ue("/")},async loadPayments({state:e}){try{let t=await a["a"].axios.get("/payments");e.user.payments=t.data}catch(t){commit("error",t.response?t.response.data:t.message)}},async setupNotifications({commit:e,getters:t,dispatch:s}){"Notification"in window&&("granted"===Notification.permission?navigator.serviceWorker.ready.then((function(e){return e.pushManager.getSubscription().then((async function(t){if(t)return t;function s(e){const t="=".repeat((4-e.length%4)%4),s=(e+t).replace(/-/g,"+").replace(/_/g,"/"),a=window.atob(s),n=new Uint8Array(a.length);for(let r=0;r<a.length;++r)n[r]=a.charCodeAt(r);return n}const a=s("BEoTndzPq2wq5607eFa4ByiGhWvSV8M9wWj_lKEHr5o97swpBm7tA4cnx5PGk2ftA6ZnzY0PZV-Mx_NK6FgcGWk");return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:a})}))})).then((function(t){a["a"].axios.post("/subscribe",{subscription:t}),e("subscription",t)})):"denied"!==Notification.permission&&Notification.requestPermission().then(()=>s("setupNotifications")))},async setupSocket({commit:e,getters:t,dispatch:s}){await new Promise((a,n)=>{setTimeout(n,5e3);const r="wss://";if(!t.token)return n();if(t.socket){if(1===t.socket.readyState)return a();e("socket",null)}let o=new WebSocket(`${r}${location.host}/ws`);e("socket",o),o.onopen=()=>{o.send(JSON.stringify({type:"login",data:t.token})),e("error",null)},o.onerror=()=>{e("error","Problem connecting to server"),o.close(),n()},o.onclose=async e=>{o=null,n();try{await s("setupSocket")}catch(e){}},o.onmessage=n=>{let{type:r,data:o}=JSON.parse(n.data);switch(r){case"version":e("version",o.trim());break;case"login":o?(e("user",o),s("setupNotifications"),a()):s("logout");break;case"account":e("addAccount",o);break;case"payment":e("addPayment",o);break;case"accounts":t.user.accounts=o;break;case"rates":const n=o;if(!n)return;e("rates",n),t.user&&t.user.currency&&e("rate",n[t.user.currency]);break;case"otpsecret":e("user",{...Ke.user,otpsecret:o});break;case"to":let{payment:r}=t;r.recipient=o;break;case"user":e("user",o);break}}})},async issueAsset({commit:e,dispatch:t},s){try{await a["a"].axios.post("/assets",s),Ue("/assets")}catch(n){e("error",n.response?n.response.data:n.message)}},async createUser({commit:e,dispatch:t},s){try{await a["a"].axios.post("/register",{user:s}),t("login",s)}catch(n){e("error",n.response?n.response.data:n.message)}},async updateUser({commit:e,dispatch:t,state:s},n){let r={};Object.keys(n).map(e=>{["payments","account"].includes(e)||(r[e]=n[e])});try{let t=await a["a"].axios.post("/user",r);return e("user",t.data.user),t.data.token&&e("token",t.data.token),!0}catch(o){return e("error",o.response?o.response.data:o.message),!1}},async estimateFee({commit:e,getters:t}){e("error",null),e("loadingFee",!0);let{payment:s,user:n}=t,{asset:r}=n.account,{address:o,amount:i,feeRate:c}=s,u={address:o,amount:i,asset:r,feeRate:c};if(o)if(We(o))try{let t=await a["a"].axios.post("/liquid/fee",u);s.feeRate=t.data.feeRate,s.tx=t.data.tx,e("psbt",t.data.psbt)}catch(l){e("error",l.response?l.response.data:l.message)}else try{let e=await a["a"].axios.post("/bitcoin/fee",u);s.feeRate=e.data.feeRate,s.tx=e.data.tx}catch(l){e("error",l.response?l.response.data:l.message)}e("loadingFee",!1)},async sendInternal({commit:e,dispatch:t,getters:s}){let{payment:{amount:n,recipient:{username:r}},user:o}=s,i=o.account.asset;if(n<=0)return e("error","Amount must be greater than zero");try{let t=await a["a"].axios.post("/send",{amount:n,asset:i,username:r});t.data.sent=!0,e("payment",t.data)}catch(c){e("error",c.response?c.response.data:c.message)}},async buildSweepTx({commit:e,dispatch:t,getters:s},n){let{ecpair:r,payment:o,rate:i}=s,{address:c,amount:u,feeRate:l}=o;e("error",null);try{let t=await a["a"].axios.post("/bitcoin/sweep",{address:n,amount:u,feeRate:l,target:c}),{psbt:s,total:p}=t.data;s=Fe["Psbt"].fromBase64(s).signAllInputs(r).finalizeAllInputs(),p&&(o.amount=p,o.fiatAmount=(p*i/Me).toFixed(2)),o.fee=s.getFee(),o.tx=s.extractTransaction(),o.tx.fee=o.fee/Me,o.txid=o.tx.txid,o.feeRate=t.data.feeRate,e("payment",o)}catch(p){e("error",p.response?p.response.data:p.message)}},async sweep({commit:e,getters:t}){let{payment:s,rate:n,user:r}=t,o=s.tx.toHex();try{await a["a"].axios.post("/electrs/tx",o),s.account=r.accounts.find(e=>e.asset===He),s.sent=!0,s.rate=n,s.currency=r.currency,s.amount+=s.fee}catch(i){e("error",i.response?i.response.data:i.message)}},async sendPayment({commit:e,dispatch:t,getters:s}){e("loading",!0),e("error",null);let{payment:{address:n,amount:r,asset:o,tx:i,payreq:c,route:u}}=s;if(c.startsWith("ln"))try{let t=await a["a"].axios.post("/lightning/send",{amount:r,payreq:c,route:u});t.data.sent=!0,e("payment",t.data)}catch(l){e("error",l.response?l.response.data:l.message)}else if(n){if(i||await t("estimateFee"),i=s.payment.tx,!i)return e("loading",!1);if(We(n))try{let t=await a["a"].axios.post("/liquid/send",{address:n,asset:o,tx:i});t.data.sent=!0,e("payment",t.data)}catch(l){e("error",l.response?l.response.data:l.message)}else try{let t=await a["a"].axios.post("/bitcoin/send",{address:n,tx:i});t.data.sent=!0,e("payment",t.data)}catch(l){e("error",l.response?l.response.data:l.message)}}e("loading",!1)},async clearInvoice({commit:e,state:t}){let s=JSON.parse(Ge);s.currency=t.user.currency,s.rate=t.rate,e("invoice",s),e("error",null)},async clearPayment({commit:e}){let t=JSON.parse(De);e("payment",t),e("error",null)},async addInvoice({commit:e,state:t},s){const{invoice:n,user:r}=t;n.amount||(n.amount=null);const{amount:o,tip:i}=n;s=s||n.method,n.method=s,n.network=Re[s];const c=e=>o?`${s}:${e}?amount=${((o+i)/Me).toFixed(8)}`:e;let u;switch(s){case"bitcoin":({address:u}=r),n.address=u,n.text=c(u);break;case"liquid":({confidential:u}=r);let t=c(u);t=t.replace("liquid","liquidnetwork"),o&&(t+="&asset="+r.account.asset),n.address=u,n.text=t;break;case"lightning":try{let{data:e}=await a["a"].axios.post("/lightning/invoice",{amount:o,tip:i});n.text=e}catch(l){e("error",l.response?l.response.data:l.message)}break}try{await a["a"].axios.post("/invoice",{invoice:n}),e("invoice",n)}catch(l){e("error",l.response?l.response.data:l.message)}},async paste({commit:e,dispatch:t}){Ue("/pasted")},async updateAccount({commit:e,dispatch:t,state:s},n){try{await a["a"].axios.post("/account",n)}catch(r){e("error",r.response?r.response.data:r.message)}},async shiftAccount({commit:e,dispatch:t,getters:s},n){let{user:r}=s;if("string"!==typeof n){let e=r.accounts.findIndex(e=>e.id===r.account.id),s=r.accounts[e].asset;if(s===He&&(await t("toggleUnit"),"SAT"===r.unit))return;e>=r.accounts.length-1?e=0:e++,n=r.accounts[e].asset}n!==He&&"SAT"===r.unit&&t("toggleUnit"),await a["a"].axios.post("/shiftAccount",{asset:n})},async getRecipient({commit:e,dispatch:t,getters:s},n){try{let{payment:t}=s;t.recipient=(await a["a"].axios.get("/users/"+n)).data,e("error",null)}catch(r){e("error","User not found")}},async handleScan({commit:e,dispatch:t,getters:s},n){if(!n)return;if("string"!==typeof n)return $e.go(-1);await t("clearPayment");let r,{nodes:o,payment:i,user:c}=s;if(o.includes("lightning"))try{"lightning:"===n.slice(0,10)&&(n=n.slice(10));let r=n.toLowerCase();i.payreq=r,i.payobj=qe.a.decode(i.payreq);let{coinType:o}=i.payobj;if("bitcoin"!==o)throw t("clearPayment"),e("error",`Wrong network, '${o}' instead of 'bitcoin'`),new Error;return"BTC"!==c.account.ticker&&await t("shiftAccount","6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d"),i.amount=i.payobj.satoshis,i.fiatAmount=(i.payobj.satoshis*s.rate/Me).toFixed(2),i.network="LNBTC",await a["a"].axios.post("/lightning/query",{payreq:r}),void Ue({name:"send",params:{keep:!0}})}catch(u){u.response&&e("error",u.response.data)}try{o.includes("bitcoin")&&(r=Ie.a.decode(n),i.network="BTC",r.options.asset=He)}catch(u){if(o.includes("liquid"))try{r=Ie.a.decode(n,"liquidnetwork"),i.network="LBTC"}catch(u){}}if(r){let a=c.accounts.find(e=>e.asset===r.options.asset);return a?(await t("shiftAccount",a.asset),i.address=r.address,r.options.amount&&(i.amount=parseInt((r.options.amount*Me).toFixed(0)),i.fiatAmount=(i.amount*s.rate/Me).toFixed(2)),await t("estimateFee"),void Ue({name:"send",params:{keep:!0}})):e("error","Unrecognized asset")}if(o.includes("bitcoin")&&Object(Le["a"])(n))return i.address=n,i.network="BTC",void Ue({name:"send",params:{keep:!0}});if(o.includes("liquid")&&We(n))return i.address=n,i.network="LBTC",void Ue({name:"send",params:{keep:!0}});if(n.startsWith("6P"))return e("text",n),Ue("/decrypt");try{const t=Fe["networks"]["bitcoin"];let s=Fe["ECPair"].fromWIF(n,t);e("ecpair",s),Ue("/sweep")}catch(u){console.log(u.message)}},async generateBlock({commit:e},t){a["a"].axios.get(`/${t}/generate`)},async showText({commit:e},t){e("text",t),Ue("/text")},async snack({commit:e},t){e("snack",t)}},mutations:{...l["d"].mutations(Ke),addAccount(e,t){let s=e.user.accounts.findIndex(e=>e.id===t.id);s>-1?e.user.accounts[s]=t:e.user.accounts.unshift(t),e.user.account.id===t.id&&(e.user.account=t),e.user=JSON.parse(JSON.stringify(e.user))},addPayment(e,t){t.amount>0&&(e.received=t,e.invoice.received+=parseInt(Math.abs(t.amount))),e.invoice.received>=e.invoice.amount&&(e.invoices.unshift(JSON.parse(JSON.stringify(e.invoice))),e.invoice.amount=0,e.invoice.fiatAmount=0);let s=e.user.payments.findIndex(e=>e.id===t.id);s>-1?e.user.payments[s]=t:e.user.payments.unshift(t),e.user=JSON.parse(JSON.stringify(e.user))},error(e,t){e.error=t,t&&t.toString().includes("502 Bad")&&(e.error="Problem connecting to server")},token(e,t){window.sessionStorage.setItem("token",t),a["a"].axios.defaults.headers.common={Authorization:"bearer "+t},e.token=t},user(e,t){t&&e.user?(t.account&&"BTC"!==t.account.ticker&&(e.fiat=!1),t.currencies&&!Array.isArray(t.currencies)&&(t.currencies=JSON.parse(t.currencies)),Object.keys(t).map(s=>e.user[s]=t[s]),e.user=JSON.parse(JSON.stringify(e.user))):e.user=t||{}},version(e,t){let s="f8fe180e38766e881bb2b8b47a986a1414479851".trim();t!==s&&(e.versionMismatch=`Server expected ${t} currently running ${s}`)}},getters:l["d"].getters(Ke)}),Qe=s("fe3c"),Xe=s.n(Qe);const Ye={install(e,t){e.prototype.$format=function(e,t){return void 0===t&&(t="SAT"===this.user.unit?0:this.user.account.precision),Je(e,t)},e.prototype.$go=function(e){this.$router.push(e).then().catch(()=>{})}}};var et=Ye,tt=s("f309"),st=s("fcf4");a["a"].use(tt["a"]);var at=new tt["a"]({theme:{dark:!0,themes:{dark:{primary:st["a"].yellow,secondary:"#333",accent:st["a"].yellow,error:"#b71c1c"}}},icons:{iconfont:"mdi"}});i.a.defaults.baseURL="/api",a["a"].use(r.a,i.a),a["a"].use(et);new a["a"]({render:e=>e(he),router:$e,vuetify:at,store:Ze}).$mount("#app");"addEventListener"in document&&document.addEventListener("DOMContentLoaded",(function(){Xe.a.attach(document.body)}),!1)},6:function(e,t){},"626b":function(e,t,s){},"7faf":function(e,t,s){"use strict";var a=s("111d"),n=s.n(a);n.a},c2d7:function(e,t,s){}});
//# sourceMappingURL=app.cd6f298b.js.map